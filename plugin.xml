<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   <extension point="org.eclipse.ui.handlers">
      <handler commandId="il.org.spartan.commands.SpartanizeAll" class="il.org.spartan.plugin.SpartanizeAll"/>
      <handler commandId="il.org.spartan.commands.SpartanizeCurrent" class="il.org.spartan.plugin.SpartanizeCurrent"/>
      <handler commandId="il.org.spartan.commands.SuggestionToggle" class="il.org.spartan.plugin.SuggestionsOnOfToggle"/>
   </extension>
  <extension point="org.eclipse.ui.commands">
      <category id="il.org.spartan" name="Spartanization commands"/>
      <command categoryId="il.org.spartan" id="il.org.spartan.commands.SpartanizeAll" name="Spartanize entire project"/>
      <command categoryId="il.org.spartan" id="il.org.spartan.commands.SpartanizeCurrent" name="Spartanize active window" />
      <command categoryId="il.org.spartan" id="il.org.spartan.commands.SuggestionToggle"
            name="Suggestions on/off">
            <state
              class="org.eclipse.ui.handlers.RegistryToggleState:true"
              id="org.eclipse.ui.commands.toggleState">
            </state>
      </command>
   </extension>
   <extension point="org.eclipse.core.resources.builders" name="Spartanizer" id="il.org.spartan.spartanizer.BuilderID">
      <builder hasNature="true">
         <run class="il.org.spartan.plugin.Builder"/> 
      </builder>
   </extension>
   <extension point="org.eclipse.core.resources.natures" name="Spartanizable" id="il.org.spartan.spartanizer.NatureID">
      <builder id="il.org.spartan.spartanizer.BuilderID"/> 
      <runtime>
         <run class="il.org.spartan.plugin.Nature"/> 
      </runtime>
   </extension>
   <extension point="org.eclipse.core.runtime.applications" name="Spartan Refactoring Application" id="il.org.spartan.spartanizer.application">
     <application>
     	<run class="il.org.spartan.spartanizer.application.Application"></run>
     </application>
   </extension>
      <extension
     id="il.org.spartan.spartanizer.collectmetricsapp"
     name="Collect Metrics Before and After Spartanization"
     point="org.eclipse.core.runtime.applications">
     <application>
     	<run class="il.org.spartan.spartanizer.application.CollectMetricsApp"></run>
     </application>
   </extension>
   <extension point="org.eclipse.ui.startup">
     <startup class="il.org.spartan.plugin.Plugin"/>
   </extension>

<extension
    id="il.org.spartan.spartanizer.suggestion"
    name="Spartanization"
    point="org.eclipse.core.resources.markers">
  <super type="org.eclipse.core.resources.problemmarker" />
</extension>
   <extension point="org.eclipse.ui.ide.markerResolution">
      <markerResolutionGenerator 
               markerType="il.org.spartan.spartanizer.suggestion"
         class="il.org.spartan.plugin.QuickFixer"/>
   </extension>
   <extension point="org.eclipse.ui.editors.annotationTypes">
     <type markerType="il.org.spartan.spartanizer.suggestion" 
       name="il.org.spartan.plugin.spartanizationMarker" />
   </extension>
   <extension point="org.eclipse.ui.editors.markerAnnotationSpecification">
   <specification
         annotationType="il.org.spartan.plugin.spartanizationMarker"
         colorPreferenceKey="il.org.spartan.plugin.spartanizationMarker.color"
         colorPreferenceValue="0,0,180"
         contributesToHeader="false"
         includeOnPreferencePage="true"
         label="Suggestion"
         overviewRulerPreferenceKey="il.org.spartan.plugin.spartanizationMarker.overview"
         overviewRulerPreferenceValue="true"
         presentationLayer="0"
         textPreferenceKey="il.org.spartan.plugin.spartanizationMarker.text"
         textPreferenceValue="true"
         textStylePreferenceValue="PROBLEM_UNDERLINE"
         verticalRulerPreferenceKey="il.org.spartan.plugin.spartanizationMarker.ruler"
         verticalRulerPreferenceValue="true">
   </specification>
</extension>
      <extension point="org.eclipse.ui.menus">
      <menuContribution locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
         <toolbar id="il.org.spartan.plugin.toolbars.spartanToolbar">
            <command 
            tooltip="Fully spartanize compilation unit"
              commandId="il.org.spartan.commands.SpartanizeAll"
                  icon="src/main/icons/spartan-warrior.gif"
                  id="il.org.spartan.plugin.toolbars.HelmetButton">
            </command>
         </toolbar>
      </menuContribution>
      <menuContribution
            allPopups="true"
            locationURI="popup:org.eclipse.ui.popup.any?after=additions">
         <menu
               id="il.org.spartan.menus.spartanization"
               label="Spartanization"
               mnemonic="S">
            <command label="Enable spartan suggestions"
                  commandId="il.org.spartan.commands.SuggestionToggle"
                  id="il.org.spartan.menus.Toggle"
                  style="toggle"
                  mnemonic="S">
            </command>
            <visibleWhen>
               <iterate
                     ifEmpty="false"
                     operator="and">
                  <adapt
                        type="org.eclipse.core.resources.IProject">
                  </adapt>
               </iterate>
            </visibleWhen>
         </menu>
      </menuContribution>
      <menuContribution
            locationURI="menu:org.eclipse.ui.main.menu?before=navigate">
         <menu
               id="org.eclipse.jdt.ui.refactoring.menu"
               label="Refactor">
            <menu label="Spartanization">
               <command
                     label="spartanize active window"
                     commandId="il.org.spartan.commands.SpartanizeAll"
                     id="il.org.spartan.plugin.menus.SpartanizeCurrentCommand"
                     style="push">
               </command>
               <command
                     label="spartanize entire project"
                     commandId="il.org.spartan.commands.SpartanizeCurrent"
                     id="il.org.spartan.plugin.menus.ApplySpartanizationCommand"
                     style="push">
               </command>
               <command
                     label="Show suggestions"
                     commandId="il.org.spartan.commands.SuggestionToggle"
                     id="il.org.spartan.plugin.menus.SuggestionToggle"
                     style="toggle">
               </command>
            </menu>
         </menu>
      </menuContribution>
      <menuContribution allPopups="true" locationURI="popup:org.eclipse.ui.popup.any?after=additions">
         <menu
               id="org.eclipse.jdt.ui.refactoring.menu2"
               label="Spartanization">
            <command commandId="il.org.spartan.commands.SpartanizeAll" style="push"/>

            <visibleWhen>
               <and>
                  <with
                        variable="activeEditorInput">
                     <adapt
                           type="org.eclipse.core.resources.IResource">
                        <test
                              forcePluginActivation="true"
                              property="org.eclipse.core.resources.extension"
                              value="java">
                        </test>
                     </adapt>
                  </with>
                  <not>
                     <iterate
                           ifEmpty="true"
                           operator="or">
                        <adapt
                              type="org.eclipse.core.resources.IResource">
                        </adapt>
                     </iterate>
                  </not>
               </and>
            </visibleWhen>
         </menu>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.preferencePages">
      <page
            class="il.org.spartan.plugin.PreferencesPage"
            id="il.org.spartan.plugin.PluginPreferencesPage"
            name="Spartanization"
            category="org.eclipse.jdt.ui.preferences.JavaBasePreferencePage">
      </page>
   </extension>
   <extension
         id="id1"
         point="org.eclipse.core.resources.markers">
   </extension>
   <extension
           point="org.eclipse.core.runtime.preferences">
           <scope name="PluginPreferencesPage" class="il.org.spartan.plugin.PreferencesPage"/>
        <initializer
              class="il.org.spartan.plugin.PreferencesDefaultValuesInitializer">
        </initializer>
  </extension>
</plugin>
